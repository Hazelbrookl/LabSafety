def generate_risk_analyze_prompt(experiment_name, experiment_description, step_description):
    risk_analyze_prompt_template = f"""
输入{experiment_name}实验中一个操作步骤的安全风险分析内容，该实验的实验目标和过程简述为{experiment_description}，请协助完成以下分析,并严格按照示例格式输出：
风险因素列表：
(1)物理性危险和有害因素
设备、设施、工具、附件等缺陷
防护缺陷
电伤害
噪声
明火
振动危害
电离辐射
非电离辐射
运动物伤害
高温物质
低温物质
信号缺陷
标志缺陷
高压
(2)化学性危险和有害因素（可参考化学品安全技术说明书，即 MSDS 或 SDS）
爆炸物
易燃气体
粉尘
气溶胶（气雾剂）
氧化性气体
加压气体
易燃液体
易燃固体
自反应物质和混合物
自热物质和混合物
自燃液体
自燃固体
遇水放出易燃气体的物质和混合物
金属腐蚀物
氧化性液体
氧化性固体
有机过氧化物
健康危害化学品(毒性、刺激性、腐蚀性、致敏、致癌、吸入危害等)
环境危害化学品（危害水生环境、臭氧层等）
国家管制类化学品：易制毒
国家管制类化学品：易制爆
国家管制类化学品：其他
(3)生物性危险和有害因素
致病微生物
传染病媒介物
致害动物
致害植物
(4)环境危险和有害因素
室内作业场所环境不良
室外作业场所环境不良
地下（含水下）作业场所环境不良
(5)心理、生理性危险和有害因素
负荷超限：体力、听力、视力等负荷超限
健康状况异常
从事禁忌作业
心理异常：情绪异常、冒险心理、过度紧张等
辨识功能缺陷：感知延迟、辨识错误等
(6)行为性危险和有害和因素
指挥错误：指挥失误、违章指挥
操作失误：误动作、违章作业
监护失误
该操作中包含风险因素列表中哪些类型的风险因素？
防护措施列表：
实验室工程控制措施： 
通风橱
手套箱/隔音器
局部通风
泄露报警
生物安全柜
化学品存储要求________
实验监控/值守要求________
个人防护（PPE）： 
手套（手套类型________）
护目镜
实验服/防护服
呼吸系统防护用具（面罩类型________）
其他防护措施：
其他________
针对风险因素，应当采取列表中的哪些措施？
输入示例：
简要实验步骤及具体的实验条件：系统搭建：连接光伏板、电解池、DC/DC，储氢罐、控制器
识别实验危险源：触电风险、碱液泄露风险
风险评估：概率中等 后果严重 
风险最小化措施：断电连接，检查电解槽密闭性 
应急处理：若发生泄露，使用硼酸中和泄露的碱液
输出示例：
物理性危险和有害因素-电伤害
化学性危险和有害因素-易燃气体-通风橱、局部通风、泄露报警
化学性危险和有害因素-健康危害化学品-手套（类型：天然橡胶手套）
化学性危险和有害因素-环境危害化学品
防护措施：
实验室工程控制措施：
通风橱
局部通风
泄露报警
实验监控/值守要求（实时温度监控）
个人防护（PPE）：
手套（类型：天然橡胶手套）
其他防护措施：
...
输入内容：
{step_description}
"""
    return risk_analyze_prompt_template

def generate_step_analyze_prompt(experiment_name, experiment_description, step_description):
    step_analyze_prompt_template = f"""
输入{experiment_name}实验中一个操作步骤的安全风险分析内容，该实验的实验目标和过程简述为{experiment_description}，请仔细思考该步骤可能包含哪些安全风险，从风险因素列表中选择对应的风险源，同时判断该步骤中需要采取哪些防护措施，从防护要求列表中选择对应的措施，最后提供一段针对该步骤分析内容的反馈，分析输入内容对风险源识别是否到位，是否缺失风险源的详细描述以及是否采取了正确的防护措施等。结果严格按照示例格式输出：
风险因素列表：
(1)物理性危险和有害因素
设备、设施、工具、附件等缺陷
防护缺陷
电伤害
噪声
明火
振动危害
电离辐射
非电离辐射
运动物伤害
高温物质
低温物质
信号缺陷
标志缺陷
高压
(2)化学性危险和有害因素（可参考化学品安全技术说明书，即 MSDS 或 SDS）
爆炸物
易燃气体
粉尘
气溶胶（气雾剂）
氧化性气体
加压气体
易燃液体
易燃固体
自反应物质和混合物
自热物质和混合物
自燃液体
自燃固体
遇水放出易燃气体的物质和混合物
金属腐蚀物
氧化性液体
氧化性固体
有机过氧化物
健康危害化学品(毒性、刺激性、腐蚀性、致敏、致癌、吸入危害等)
环境危害化学品（危害水生环境、臭氧层等）
国家管制类化学品：易制毒
国家管制类化学品：易制爆
国家管制类化学品：其他
(3)生物性危险和有害因素
致病微生物
传染病媒介物
致害动物
致害植物
(4)环境危险和有害因素
室内作业场所环境不良
室外作业场所环境不良
地下（含水下）作业场所环境不良
(5)心理、生理性危险和有害因素
负荷超限：体力、听力、视力等负荷超限
健康状况异常
从事禁忌作业
心理异常：情绪异常、冒险心理、过度紧张等
辨识功能缺陷：感知延迟、辨识错误等
(6)行为性危险和有害和因素
指挥错误：指挥失误、违章指挥
操作失误：误动作、违章作业
监护失误

基本防护要求:
实验室工程控制措施
通风橱 手套箱/隔音器 局部通风 泄露报警
生物安全柜 化学品存储要求：___
实验监控/值守要求：___
个人防护（PPE）
手套：___
护目镜 实验服/防护服 
呼吸系统防护用具:___
如果还有其他防护措施，请在下面写出。
其他：___

请将结果输出为json格式，示例如下：
{{
	"危险和有害因素": {{
		"物理性危险和有害因素": [...],
		"化学性危险和有害因素": [...],
		"生物性危险和有害因素": [...],
		"环境危险和有害因素": [...],
		"心理、生理性危险和有害因素": [...],
		"行为性危险和有害和因素": [...]
	}},
    "基本防护要求": {{
		"实验室工程控制措施": ["手套箱/隔音器", "化学品存储要求：密封保存", ...],
        "个人防护（PPE）": ["呼吸系统防护用具：半面罩", ...],
        "其他": [...]
	}},
    "反馈意见": "..."
}}
严格确保输出选项文本与给出的列表中相一致。
输入步骤：
{step_description}
"""
    return step_analyze_prompt_template

def generate_risk_compare_prompt(experiment_name, input_description):
    risk_compare_prompt_template = f"""
输入为{experiment_name}实验中一个操作步骤的安全风险分析内容，请根据其对应的风险因素判断分析内容是否到位，如是否缺失重要电压温度等风险条件、具体存在风险的物质等，若无明显缺漏，输出“无”即可。
输入示例：
简要实验步骤及具体的实验条件：系统搭建：连接光伏板、电解池、DC/DC，储氢罐、控制器
识别实验危险源：触电风险、碱液泄露风险
风险评估：概率中等 后果严重 
风险最小化措施：断电连接，检查电解槽密闭性 
应急处理：若发生泄露，使用硼酸中和泄露的碱液
物理性危险和有害因素-电伤害
化学性危险和有害因素-易燃气体
化学性危险和有害因素-健康危害化学品
化学性危险和有害因素-环境危害化学品
输出示例：
化学性危险和有害因素-易燃气体-种类未提及
化学性危险和有害因素-健康危害化学品-种类未提及
化学性危险和有害因素-环境危害化学品-种类未提及
输入内容：
{input_description}
"""
    return risk_compare_prompt_template

def generate_procedure_extract_prompt(experiment_name, step_description):
    procedure_extract_prompt_template = f"""
以下是{experiment_name}实验安全报告的过程简述，请对每个实验操作提取如下信息：
实验操作1
使用的全部药品：药品名-药品形态-药品用量
使用的设备：设备名-设备材质
反应环境：环境名
反应操作：操作名
反应条件：条件名
实验操作2：
...
请尽可能提取原文中确切出现的内容，不要遗漏内容，无对应信息的字段可以不填写。请严格按照格式输出，不要新增其他字段。反应操作应选取该步骤的核心操作，仅填写一个。
输入文本：
{step_description}
"""
    return procedure_extract_prompt_template

def generate_pdf_analyze_prompt(pdf_content):
    pdf_analyze_prompt_template = f"""
输入为一份实验安全分析报告文本，从实验步骤的描述中识别并输出其每一步对应的风险源因素种类和对应防护措施。
你需要关注的范围是实验过程的风险分析部分，“工作地点是否还存在以下危险和有害因素，如果有，请勾选。”这句话及以下部分都不需要分析。风险源和防护措施列表如下：
风险因素列表：
(1)物理性危险和有害因素
设备、设施、工具、附件等缺陷
防护缺陷
电伤害
噪声
明火
振动危害
电离辐射
非电离辐射
运动物伤害
高温物质
低温物质
信号缺陷
标志缺陷
高压
(2)化学性危险和有害因素（可参考化学品安全技术说明书，即 MSDS 或 SDS）
爆炸物
易燃气体
粉尘
气溶胶（气雾剂）
氧化性气体
加压气体
易燃液体
易燃固体
自反应物质和混合物
自热物质和混合物
自燃液体
自燃固体
遇水放出易燃气体的物质和混合物
金属腐蚀物
氧化性液体
氧化性固体
有机过氧化物
健康危害化学品(毒性、刺激性、腐蚀性、致敏、致癌、吸入危害等)
环境危害化学品（危害水生环境、臭氧层等）
国家管制类化学品：易制毒
国家管制类化学品：易制爆
国家管制类化学品：其他
(3)生物性危险和有害因素
致病微生物
传染病媒介物
致害动物
致害植物
(4)环境危险和有害因素
室内作业场所环境不良
室外作业场所环境不良
地下（含水下）作业场所环境不良
(5)心理、生理性危险和有害因素
负荷超限：体力、听力、视力等负荷超限
健康状况异常
从事禁忌作业
心理异常：情绪异常、冒险心理、过度紧张等
辨识功能缺陷：感知延迟、辨识错误等
(6)行为性危险和有害和因素
指挥错误：指挥失误、违章指挥
操作失误：误动作、违章作业
监护失误

防护措施列表：
实验室工程控制措施： 
通风橱
手套箱/隔音器
局部通风
泄露报警
生物安全柜
化学品存储要求________
实验监控/值守要求________
个人防护（PPE）： 
手套（手套类型________）
护目镜
实验服/防护服
呼吸系统防护用具（面罩类型________）
其他防护措施：
其他________

请将结果输出为json格式，示例如下：
{{
	"hazards": [{{
			"step":1,
			"hazard":"易燃气体",
			"description":"实验产生氢气"
		}},
		{{
			"step":1,
			"hazard":"电伤害",
			"description":"电压为2kV"
		}},
		...
	],
	"protective measures": [{{
			"step":1,
			"protective measure":"通风橱",
			"description":""
		}},
		{{
			"step":1,
			"protective measure":"手套",
			"description":"天然橡胶手套"
		}},
		...
	],
}}
严格确保输出内容中的hazard和protective measure字段与提供列表中的相一致。
输入文本：
{pdf_content}
"""
    return pdf_analyze_prompt_template

def generate_description_extract_prompt(pdf_content):
    description_extract_prompt_template = f"""
输入为一份实验安全分析报告文本，请从中分别提取“课题名称”、“实验目标及过程简述”和“实验过程的风险分析”部分的文本并输出。
请将结果输出为json格式，示例如下：
{{
	"课题名称": "针对实用化锂金属负极骨架材料设计研究",
    "实验目标及过程简述": "用油浴加热制备四氧化三铁颗粒，将四水氯化亚铁和六水氯化铁的水溶液（总计100ml）在油浴锅中加热至90度保持一小时，并滴加氨水（使用针筒滴加6ml）。（相关操作需衣启远/郭霄泽同学配合操作）",
	"实验过程的风险分析": [{{
			"简要实验步骤": "在管式炉中高温处理聚合物"
			"主要危险源":"管式炉",
			"风险分析":"内部高温（最高900摄氏度），需要保证仪器气密性，并使用氮气/氩气惰性气体进行保护。",
            "控制和防护措施":"实验前要检查气密性，运行过程中保证有人值守。",
            "突发情况处理":"使用需实时时刻检查气密性和升温情况，出现异常及时切断电源。"
		}},
		{{
			"简要实验步骤": "油浴加热"
			"主要危险源":"油浴锅",
			"风险分析":"使用油浴温度不高于90℃，连续时间不长于1.5h。",
            "控制和防护措施":"远离火种、热源。保持油浴锅周围环境干燥，防止水或其他液体进入油浴锅内。",
            "突发情况处理":"观察油浴锅控温状态，保证人员安全，发生异常情况时及时断电。"
		}},
		...
	],
}}
严格确保输出内容及结构与原始文本一致。
输入文本：
{pdf_content}
"""
    return description_extract_prompt_template 

def generate_checkbox_extract_prompt(pdf_content):
    checkbox_extract_prompt_template = f"""
输入为一份实验安全分析报告文本，请从中提取“工作地点是否还存在以下危险和有害因素”和“基本防护要求”部分的勾选情况。
风险因素列表：
(1)物理性危险和有害因素
设备、设施、工具、附件等缺陷
防护缺陷
电伤害
噪声
明火
振动危害
电离辐射
非电离辐射
运动物伤害
高温物质
低温物质
信号缺陷
标志缺陷
高压
(2)化学性危险和有害因素（可参考化学品安全技术说明书，即 MSDS 或 SDS）
爆炸物
易燃气体
粉尘
气溶胶（气雾剂）
氧化性气体
加压气体
易燃液体
易燃固体
自反应物质和混合物
自热物质和混合物
自燃液体
自燃固体
遇水放出易燃气体的物质和混合物
金属腐蚀物
氧化性液体
氧化性固体
有机过氧化物
健康危害化学品(毒性、刺激性、腐蚀性、致敏、致癌、吸入危害等)
环境危害化学品（危害水生环境、臭氧层等）
国家管制类化学品：易制毒
国家管制类化学品：易制爆
国家管制类化学品：其他
(3)生物性危险和有害因素
致病微生物
传染病媒介物
致害动物
致害植物
(4)环境危险和有害因素
室内作业场所环境不良
室外作业场所环境不良
地下（含水下）作业场所环境不良
(5)心理、生理性危险和有害因素
负荷超限：体力、听力、视力等负荷超限
健康状况异常
从事禁忌作业
心理异常：情绪异常、冒险心理、过度紧张等
辨识功能缺陷：感知延迟、辨识错误等
(6)行为性危险和有害和因素
指挥错误：指挥失误、违章指挥
操作失误：误动作、违章作业
监护失误

基本防护要求:
实验室工程控制措施
通风橱 手套箱/隔音器 局部通风 泄露报警
生物安全柜 化学品存储要求：___
实验监控/值守要求：___
个人防护（PPE）
手套：___
护目镜 实验服/防护服 
呼吸系统防护用具:___
如果还有其他防护措施，请在下面写出。
其他：___

请将结果输出为json格式，示例如下：
{{
	"危险和有害因素": {{
		"物理性危险和有害因素": [...],
		"化学性危险和有害因素": [...],
		"生物性危险和有害因素": [...],
		"环境危险和有害因素": [...],
		"心理、生理性危险和有害因素": [...],
		"行为性危险和有害和因素": [...]
	}},
    "基本防护要求": {{
		"实验室工程控制措施": ["手套箱/隔音器", "化学品存储要求：密封保存", ...],
        "个人防护（PPE）": ["呼吸系统防护用具：半面罩", ...],
        "其他": [...]
	}}
}}
严格确保输出选项与原始文本勾选的相一致，选项文本与给出的列表中的文本相一致。
输入文本：
{pdf_content}
"""
    return checkbox_extract_prompt_template 